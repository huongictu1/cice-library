CREATE FUNCTION [dbo].[SumInput]
(
    @Barcode NVARCHAR(50),
    @Month INT,
    @Year INT
)
RETURNS FLOAT
AS
BEGIN
    DECLARE @DATE_APPROVAL DATETIME = dbo.GetDateApproval(@Barcode, @Month, @Year);
    DECLARE @SumInput FLOAT;

    -- Use a single query to calculate the sum of input quantity
    SELECT @SumInput = ISNULL(SUM(cs.InputQuantity), 0)
    FROM dbo.ChemicalStore cs
    WHERE 
        cs.Barcode = @Barcode 
        AND MONTH(cs.DateCurent) = @Month 
        AND YEAR(cs.DateCurent) = @Year;

    RETURN @SumInput;
END
